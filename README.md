## Interpretable Decision Boundary Based Adequacy Testing for Deep Learning Model.

### 1. Introduction

As we cannot understand the role of neurons in model decision behavior as comprehensively as understanding source code, using model decision boundaries is more interpretable than neuron activation trajectories. Based on this, we propose a coverage testing method using decision boundaries to measure test adequacy. Simultaneously, we introduce three test adequacy evaluation criteria (*KdeBC, EdBC, MdBC*). 

Empirical studies indicate that the boundary instance generated by our method exists near decision boundaries, with an average confidence error at the model output layer of only $4.29 \times 10^{-5}$. Moreover, compared to coverage testing methods based on neuron activation trajectories, our proposed decision boundary-based coverage testing method has a stronger and significantly correlated relationship with defect detection rates, with an average correlation coefficient of 0.84, making it more effective in assessing test adequacy.

### 2. Install dependencies

You need to install following packages in order to run the code:

```
python 3.7
tensorflow-gpu 1.14.0
cuDNN 7.4
CUDA 10
foolbox 2.4.0
keras 2.2.5
numpy 1.16.0
pillow 9.5.0
```

### 3. Datasets and Models

|  **Model (Dataset)**  | **#Layers** | **#Parameters** | **Performance** |
| :-------------------: | :---------: | :-------------: | :-------------: |
|    LeNet-1 (MNIST)    |      3      |      7,206      |     98.78%      |
|    LeNet-5 (MNIST)    |      5      |     107,786     |     98.81%      |
| CIFARModel (CIFAR-10) |      7      |    1,601,474    |     74.25%      |
|   VGG-16 (CIFAR-10)   |     16      |   138,357,544   |     79.88%      |
|  ResNet50 (ImageNet)  |     54      |   23,570,388    |     76.13%      |
|   VGG19 (ImageNet)    |     19      |   143,667,240   |     72.38%      |

### 4. Performance

|                               |                           **FSGM**                           |                           **BIM**                            |                           **JSMA**                           |                            **CW**                            |
| :---------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|    **LENET1**  **(MNIST)**    | ![4-2-1-LeNet1-FSGM](https://github.com/Alan-predator/BoundaryAdequacy/blob/main/Performance/4-2-1-LeNet1-FSGM.png) | ![4-2-2-LeNet1-BIM](D:\新建文件夹\论文\Figure\Section4\4-2-2-LeNet1-BIM.png) | ![4-2-3-LeNet1-JSMA](D:\新建文件夹\论文\Figure\Section4\4-2-3-LeNet1-JSMA.png) | ![4-2-4-LeNet1-CW](D:\新建文件夹\论文\Figure\Section4\4-2-4-LeNet1-CW.png) |
|                               |                           **(a)**                            |                           **(b)**                            |                           **(c)**                            |                           **(d)**                            |
|    **LENET5**  **(MNIST)**    | ![4-2-5-LeNet5-FSGM](D:\新建文件夹\论文\Figure\Section4\4-2-5-LeNet5-FSGM.png) | ![4-2-6-LeNet5-BIM](D:\新建文件夹\论文\Figure\Section4\4-2-6-LeNet5-BIM.png) | ![4-2-7-LeNet5-JSMA](D:\新建文件夹\论文\Figure\Section4\4-2-7-LeNet5-JSMA.png) | ![4-2-8-LeNet5-CW](D:\新建文件夹\论文\Figure\Section4\4-2-8-LeNet5-CW.png) |
|                               |                           **(e)**                            |                           **(f)**                            |                           **(g)**                            |                           **(h)**                            |
| **CifarModel**  **(CIFAR10)** | ![4-2-9-CifarModel-FGSM](D:\新建文件夹\论文\Figure\Section4\4-2-9-CifarModel-FGSM.png) | ![4-2-10-CifarModel-BIM](D:\新建文件夹\论文\Figure\Section4\4-2-10-CifarModel-BIM.png) | ![4-2-11-CifarModel-JSMA](D:\新建文件夹\论文\Figure\Section4\4-2-11-CifarModel-JSMA.png) | ![4-2-12-CifarModel-CW](D:\新建文件夹\论文\Figure\Section4\4-2-12-CifarModel-CW.png) |
|                               |                           **(i)**                            |                           **(j)**                            |                           **(k)**                            |                           **(l)**                            |
|   **VGG16**  **(CIFAR10)**    | ![4-2-13-VGG16-FSGM](D:\新建文件夹\论文\Figure\Section4\4-2-13-VGG16-FSGM.png) | ![4-2-14-VGG16-BIM](D:\新建文件夹\论文\Figure\Section4\4-2-14-VGG16-BIM.png) | ![4-2-15-VGG16-JSMA](D:\新建文件夹\论文\Figure\Section4\4-2-15-VGG16-JSMA.png) | ![4-2-16-VGG16-CW](D:\新建文件夹\论文\Figure\Section4\4-2-16-VGG16-CW.png) |
|                               |                           **(m)**                            |                           **(n)**                            |                           **(o)**                            |                           **(p)**                            |
| **ResNet50**  **(ImageNet)**  | ![4-2-17-ResNet50-FSGM](D:\新建文件夹\论文\Figure\Section4\4-2-17-ResNet50-FSGM.png) | ![4-2-18-ResNet50-BIM](D:\新建文件夹\论文\Figure\Section4\4-2-19-ResNet50-JSMA.png) | ![4-2-19-ResNet50-JSMA](D:\新建文件夹\论文\Figure\Section4\4-2-19-ResNet50-JSMA.png) | ![4-2-20-ResNet50-CW](D:\新建文件夹\论文\Figure\Section4\4-2-20-ResNet50-CW.png) |
|                               |                           **(q)**                            |                           **(r)**                            |                           **(s)**                            |                           **(t)**                            |
|   **VGG19**  **(ImageNet)**   | ![4-2-21-VGG19-FSGM](D:\新建文件夹\论文\Figure\Section4\4-2-21-VGG19-FSGM.png) | ![4-2-22-VGG19-BIM](D:\新建文件夹\论文\Figure\Section4\4-2-22-VGG19-BIM.png) | ![4-2-23-VGG19-JSMA](D:\新建文件夹\论文\Figure\Section4\4-2-23-VGG19-JSMA.png) | ![4-2-24-VGG19-CW](D:\新建文件夹\论文\Figure\Section4\4-2-24-VGG19-CW.png) |
|                               |                           **(u)**                            |                           **(v)**                            |                           **(w)**                            |                           **(x)**                            |

Our study shows that decision boundaries provide an intuitive and effective means to assess the test adequacy of DL models. Our proposed criteria not only correlate well with existing metrics but also surpass them in performance.
